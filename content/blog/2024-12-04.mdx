---
title: Atualiza√ß√£o 0.8.0 - Novo visual e idiomas
tags: [cli, botbase, updates, feats]
description: Visual renovado, novo sistema de multi idioma na CLI e manipuladores de erro na base de bots
---

Essa vers√£o altera o visual da CLI, melhorando em alguns pontos a experi√™ncia de utiliza√ß√£o e a forma de visualizar as informa√ß√µes

Comando para executar a CLI

```bash
npx constatic@latest
```

## üåê Sistema multi idioma

Agora nas configura√ß√µes da CLI, √© poss√≠vel alterar o idioma!

<ImageZoom src={"/blog/2024-12-04/lang.gif"} width={1000} height={300} alt="cli" unoptimized />

> O programa tentar√° identificar a idioma do seu sistema ao utilizar a CLI pela primeira vez

## üé® Novo visual

A CLI teve o seu estilo alterado, mas n√£o √© como se ela estivesse completamente diferente, apenas pequenos detalhes mudaram, se voc√™ utiliza com frequ√™ncia j√° pode ter notado.

### üìö Mudan√ßa de bibliotecas

O pacote de componentes interativos de CLI `@clack/prompts` foi substitu√≠do pelo `@inquirer/prompts`. O pacote clack era muito bonito e moderno, contudo, faltavam alguns recursos que deixariam a CLI muito mais intuit√≠va, ent√£o foi decidido que inquirer seria a melhor op√ß√£o.

<ImageZoom src={"/blog/2024-12-04/mainmenu.svg"} width={1000} height={300} alt="cli" unoptimized />

### üóíÔ∏è Listagem em tabela

A forma como dados listados s√£o exibidos ficou um pouco mais interesssante na forma de uma tabela mais compacta e moderna

<ImageZoom src={"/blog/2024-12-04/list.svg"} width={1000} height={300} alt="cli" unoptimized />

### üóÉÔ∏è Multi sele√ß√£o de itens

Alguns menus onde s√≥ era poss√≠vel selecionar um item, ou selecionar apenas todos os itens de uma vez, agora permite que o usu√°rio marque quais itens ele quer selecionar

<ImageZoom src={"/blog/2024-12-04/select.svg"} width={1000} height={300} alt="cli" unoptimized />

### ‚å®Ô∏è Verifica√ß√µes de inputs

Alguns inputs agora tem uma verifica√ß√£o de acordo com a sua fun√ß√£o, como por exemplo o input de caminho para uma pasta de arquivos de imagem no menu de emojis, o programa ir√° verificar se o caminho existe antes que voc√™ possa enviar.

<ImageZoom src={"/blog/2024-12-04/check.svg"} width={1000} height={300} alt="cli" unoptimized />

### ‚ùáÔ∏è Altera√ß√£o de simbolos

Alguns emojis foram substitu√≠dos por caracteres de √≠cones

<ImageZoom src={"/blog/2024-12-04/options.svg"} width={1000} height={300} alt="cli" unoptimized />

## ü§ñ Base de Bot de discord

A base recebeu pequenas adi√ß√µes para se encaixar com a atualiza√ß√£o passada da ferramenta de gerenciar emojis da aplica√ß√£o

### üìë Arquivos de configura√ß√µes

Adicionado os arquivos `emojis.json` e `emojis.dev.json` na configura√ß√£o de **fileNesting** no arquivo de configura√ß√µes do vscode.

```json title=".vscode/settings.json"
{
  // ...
  "explorer.fileNesting.patterns": {
    ".env": ".env*",
    "settings.json": "emojis.json, emojis.dev.json", //[!code ++]
    "package.json": "*lock.json, *.lock, *lock.yaml, *.lockb, tsconfig.json, .eslintrc.json, .gitignore, .discloudignore, biome.json, .nvmrc"
  }
  // ...
}
```

Foi adicionado tamb√©m um atalho de caminho para o arquivo `emojis.json` no `tsconfig.json`

```json title="tsconfig.json"
{
	"compilerOptions": {
        //...
		"baseUrl": "./src",
		"paths": {
			"#database": ["./database/index.ts"],
			"#base": ["./discord/base/index.ts"],
			"#functions": ["./functions/index.ts"],
			"#menus": ["./menus/index.ts"],
			"#settings": ["./settings/index.ts"],
			"#tools": ["./tools/index.ts"],
			"#server": ["./server/index.ts"],
			"#lib": ["./lib/index.ts"],
			"#emojis": ["../emojis.json"], // [!code ++]
			"@discordjs/builders/*": ["ignore"]
		}
	},
  // ...
}
```

### ‚ñ∂Ô∏è BootstrapApp

Agora √© muito f√°cil definir um **Manipulador de erros** para [Comandos](/docs/discord/commands) e [Responders](/docs/discord/responders).

```ts title="src/index.ts"
import { bootstrapApp } from "#base";

await bootstrapApp({ 
    workdir: import.meta.dirname,
    commands: {
        onError(err, interaction){ } // [!code ++]
    },
    responders: {
        onError(err, interaction){ } // [!code ++]
    }
});
```

Voc√™ pode criar uma mensagem padr√£o para qualquer erro inesperado:

```ts title="src/index.ts"
import { bootstrapApp } from "#base";
import { log } from "#settings";
import { InteractionReplyOptions } from "discord.js";

await bootstrapApp({ 
    workdir: import.meta.dirname,
    commands: {
        onError(err, interaction){ // [!code highlight]
            log.error(err); // [!code highlight]
            
            const options = { // [!code highlight]
                content: "Ocorreu um erro inesperado!" // [!code highlight]
            } satisfies InteractionReplyOptions; // [!code highlight]
            
            interaction.reply(options) // [!code highlight]
            .catch(() => interaction.followUp(options)); // [!code highlight]
        } // [!code highlight]
    }
});
```

√â recomendado criar uma fun√ß√£o separada para melhor organiza√ß√£o:

```ts title="src/functions/handlers/errors.ts"
import { log } from "#settings";
import { CommandInteraction, InteractionReplyOptions } from "discord.js";

export function commandErrorHandler(err: unknown, interaction: CommandInteraction){
    log.error(err); 
            
    const options = { 
        content: "Ocorreu um erro inesperado!"
    } satisfies InteractionReplyOptions; 
    
    interaction.reply(options) 
    .catch(() => interaction.followUp(options)); 
}
```
```ts title="src/index.ts"
import { bootstrapApp } from "#base";
import { commandErrorHandler } from "#functions"

await bootstrapApp({ 
    workdir: import.meta.dirname,
    commands: {
        onError: commandErrorHandler
    }
});
```

<Callout type="hint">
    Voc√™ pode lan√ßar erros personalizados dentro dos comandos e responders de uma forma padronizada e tratar todos atrav√©s do handler de erros
</Callout>

<Tabs items={["Comando", "Manipulador de erro"]}>
  <Tab value="Comando" >
  ```ts title="src/discord/commands/ping.ts"
  import { Command } from "#base";
  import { CustomError } from "#functions"; // [!code highlight]
  import { ApplicationCommandType } from "discord.js";

  new Command({
    name: "ping",
    description: "Replies with pong üèì",
    type: ApplicationCommandType.ChatInput,
    run(interaction){
      const { member } = interaction;
      if (!member.permissions.has("Administrator")){ // [!code highlight]
        throw new CustomError({ // [!code highlight]
          message: "Voc√™ n√£o tem permiss√£o para fazer isso!", // [!code highlight]
        }); // [!code highlight]
      } // [!code highlight]
      // Resto do comando ...
    }
  });
  ```
  </Tab>
  <Tab value="Manipulador de erro" >
  ```ts title="src/functions/handlers/error.ts"
  import { log } from "#settings";
  import { CommandInteraction, InteractionReplyOptions } from "discord.js";

  export class CustomError extends Error { // [!code highlight]
      constructor({ message }: { message: string }) { // [!code highlight]
        super(message); // [!code highlight]
        this.name = this.constructor.name; // [!code highlight]
        this.message = message; // [!code highlight]
      } // [!code highlight]
  } // [!code highlight]

  export function commandErrorHandler(err: unknown, interaction: CommandInteraction){
      const send = (options: object) => 
          interaction.reply(options) 
          .catch(() => 
              interaction.followUp(options)
          );

      if (err instanceof CustomError){ // [!code highlight]
          const options = { 
              flags: ["Ephemeral"],
              content: `>>> Erro no sistema principal: ${err.message}` // [!code highlight]
          } satisfies InteractionReplyOptions; 
          
          send(options);
          return; // [!code highlight]
      }
      log.error(err); 
              
      const options = { 
          flags: ["Ephemeral"],
          content: "Ocorreu um erro inesperado!"
      } satisfies InteractionReplyOptions; 
      
      send(options);
  }
  ```
  </Tab>
</Tabs>

Funciona da mesma forma tanto para os Comandos, quanto para os Responders. Agora depende de voc√™ criar seus pr√≥prios manipuladores de erro do jeito que voc√™ achar melhor.

## Conclus√£o

Estes novos recursos da base est√£o em um estado experimental, pode haver bugs ou erros inesperados, caso encontre algum, reporte diretamente no discord [Zunder Community](http://discord.gg/tTu8dGN).

---

Novidades, atualiza√ß√µes, altera√ß√µes, dicas e muito mais ser√° postado neste blog! Se voc√™ quiser ser notificado sempre que uma nova postagem for publicada, entre no discord [Zunder Community](http://discord.gg/tTu8dGN) ou Siga [@rinckodev no twitter/x](https://x.com/rinckodev)
